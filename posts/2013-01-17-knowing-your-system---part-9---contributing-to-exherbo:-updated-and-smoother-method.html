<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="Keruspe's personal blog" />
        <title>Keruspe's blag - Knowing your system - Part 9 - Contributing to Exherbo: Updated and smoother method</title>
        <link href="http://fonts.googleapis.com/css?family=Arvo" rel="stylesheet" type="text/css" />
        <link href="http://fonts.googleapis.com/css?family=ABeeZee" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="alternate" type="application/rss+xml" title="Keruspe's blag" href="../rss.xml" />
        <link rel="shortcut icon" href="../favicon.png" />
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-36525806-1']);
            _gaq.push(['_setDomainName', 'imagination-land.org']);
            _gaq.push(['_setAllowLinker', true]);
            _gaq.push(['_trackPageview']);

            (function() {
                /* Google Analytics */
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                /* Google Plus */
                /*var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
                po.src = 'https://apis.google.com/js/plusone.js';
                var ss = document.getElementsByTagName('script')[0]; ss.parentNode.insertBefore(po, ss);*/
                /* Disqus */
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://keruspe.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
    </head>
    <body>
        <header>
            <hgroup>
                <h1><a href="../">Keruspe's blag</a></h1>
                <h6>-</h6>
                <h2>Various free software hacking stuff</h2>
            </hgroup>
        </header>
        <nav>
            <menu>
                <a href="../"><img src="../images/home.png" alt="home" /> Home</a>
                <a href="../posts.html"><img src="../images/list.png" alt="list" /> All posts</a>
                <!-- <a href="http://marc-antoine.perennou.com">About me</a> -->
                <a href="http://github.com/Keruspe"><img id="octocat" src="../images/octocat.png" alt="octocat" /> My projects</a>
                <a href="http://www.clever-cloud.com"><img src="../images/clever-cloud.png" alt="clever-cloud" /> My company</a>
                <a href="../rss.xml"><img src="../images/rss.png" alt="rss" /> RSS feed</a>
            </menu>
        </nav>
        <section>
            <article>
                <header>
                    <h1>Knowing your system - Part 9 - Contributing to Exherbo: Updated and smoother method</h1>
                    <p>by <em>Marc-Antoine Perennou</em> on <strong>January 17, 2013</strong></p>
                    <p>Tagged as: <a href="../tags/sysadmin.html">sysadmin</a>, <a href="../tags/knowingyoursystem.html">knowingyoursystem</a>, <a href="../tags/source-based.html">source-based</a>, <a href="../tags/exherbo.html">exherbo</a>, <a href="../tags/paludis.html">paludis</a>.</p>
                </header>

                <section>
<p>In the <a href="../posts/2013-01-03-knowing-your-system---part-7---contributing-to-exherbo.html">part 7</a>, I described my workflow for contributing to Exherbo. Since then I had a few remarks (from <a href="http://kloeri.livejournal.com/">kloeri</a>, the <a href="http://www.exherbo.org/">Exherbo</a>’s father, amongst others) on how I could improve it.</p>
<h2 id="my-new-workflow">My new workflow</h2>
<p>What I liked about my previous workflow is that it was exactly the same for contributing to Exherbo or <a href="../posts/2013-01-10-knowing-your-system---part-8---on-the-road-to-upstream.html">to upstream</a>. This is why it isn’t completely done. Most of it is actually still here, but in another way. What’s new is <code>cave sync</code>’s option <code>-s</code>, aka <code>--source</code> which allows you to specify multiple sync sources for a repository. For each repository that I install, I edit its configuration file changing <code>sync = git://git.exherbo.org/arbor.git</code> to <code>sync = git://git.exherbo.org/arbor.git local: git+file:///home/keruspe/Exherbo/arbor</code>, for example.</p>
<p>What I do now is:</p>
<ul>
<li>If I do not have a copy of the repository locally I clone it, otherwise I pull new changes from upstream</li>
<li>I write my patch and commit it</li>
<li>I sync the repository from my local patched clone: <code>cave sync -s local &lt;repository&gt;</code></li>
<li>I try my patch, compiling the related packages</li>
<li>If it fails, I go back to step two to fix my patch</li>
<li>If it succeeds, I upload it with <code>git pe -&lt;number_of_commits&gt; | wgetpaste -r -s poundpython</code> and I submit it.</li>
</ul>
<p>For the record, the command which I run to upload my patch is a git alias, <code>git pe</code> means <code>git format-patch -M -C --find-copies-harder --stdout</code></p>
<h2 id="what-has-become-my-previous-workflow">What has become my previous workflow?</h2>
<p>This does not at all look like my previous workflow, but I said I kept it around… Why?</p>
<p>Actually, my previous workflow comes right after that. Once I’ve sumitted my patch, I add it to my autopatch folder:</p>
<pre><code>mkdir -p /etc/paludis/autopatch/&lt;repository&gt;
curl &lt;patch_url&gt; &gt; /etc/paludis.autopatch/&lt;repository&gt;/my.patch</code></pre>
<p>This way, they automatically get applied when I sync back the real repository instead of my copy. If a sync fail, I rebase my patches and resubmit them. Once the patch is pushed, I can safely remove it from my autopatch directory.</p>
<p>Note that this whole second step can fully be ignored for repositories you have push access to, simplifying even more this light workflow.</p>
                </section>
            </article>

            <section class="social">
                <!--<div class="g-plusone" data-align="right"></div>-->
                <div id="disqus_thread"></div>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

        </section>
        <footer>
            <p>
                This  work is licensed under a
                <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">
                    Creative Commons Attribution-ShareAlike 3.0 Unported License
                    <img id="cc-icon" alt="Creative Commons License" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png">
                </a>.
            </p>
        </footer>
    </body>
</html>
